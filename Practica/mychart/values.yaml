###############################################################
# Varaibles globales
replicas: 1
protocol: TCP
strategy: Recreate # Cuando se actualialize del Deployment, los pods se eliminarán antes de crear nuevos 
###############################################################
# Imagenes
# Variables específicas
image:
  repo: bryyyan/practica_contendores
  webtag: appweb-k8s-v3
  dbtag: appdata-k8s-v2
  adminer: adminer
  admitag: latest
  policy: IfNotPresent
  pullhub: docker-secret
###############################################################
# Web
# Variables para el deployment y servicio web
web:
  deploy:
    apiver: apps/v1
    name: web
    port: 5000 # Puerto interno del contenedor
  service:
    name: web-srv
    targetport: 80 # Puerto expuesto al que apunta el Ingress
  # Volumen donde se guardan los logs de la web
  # Se usa persistance volumen claim  
  volumen:
    name: web-claim0
    path: /app/logs
    storage: 50Mi # Minimo para iniciar
  resources:
    mincpu: 100m # Solicita un 10% al iniciar
  limits:
    maxcpu: 1
    maxram: 500Mi
###############################################################
# Base de datos    
posgre:
  deploy:
    name: db
    port: 5432 # Puerto interno del contenedor
  service:
    name: db
    targetport: 5432 # Puerto expuesto al que apunta el Ingress
  # Volumen donde se guardan los logs de la web  
  volumen:
    name: db-data
    path: /var/lib/postgresql/data
    storage: 100Mi # Minimo para iniciar   
###############################################################
# Adminer
adminer:
  deploy:
    name: adminer
    port: 8080 # Puerto interno del contenedor
  service:
    name: adminer-srv
    targetport: 50 # Puerto expuesto al que apunta el Ingress
###############################################################
# Secrets
secret: 
  cred:
    name: db-cred
    #psqdb: test1       # POSTGRES_DB=test1 
    #psqhost: db        # DB_HOST=db
    #psqport: "5432"      # DB_PORT=5432  
    #psqdbname: test1   # DB_NAME=test1     
    #psquser: prueba1   # DB_USER=prueba1     
    #psqpass: prueba1   # DB_PASS=prueba1
    psqdb: ENC[AES256_GCM,data:37k31lg=,iv:fuyYj9n65J7rigRZF3PWL+HabHxqibm4tSZvczueYJ4=,tag:HbyTxDFDb9LrbHdEO/3Giw==,type:str]
    psqhost: ENC[AES256_GCM,data:4Zo=,iv:3ALAA1cokTxI0noAl5pMROQ1sun3KBd9FiK/JTokj/s=,tag:0c2ThgWatEMd94V95vYWEw==,type:str]
    psqport: ENC[AES256_GCM,data:/sKx2g==,iv:5TYEepCSVUR2ikMAQhb6yHlfhRjnxYci2qMmvvZYpjU=,tag:0fB9nd8l2QvOB72c+tzU2g==,type:str]
    psqdbname: ENC[AES256_GCM,data:o2uUecU=,iv:3wuND1M5tjAYTJpXc3zLJ4Ot47juaARHwu8yqB0yrq8=,tag:26EgPTh5dkMILld9Iabx4A==,type:str]
    psquser: ENC[AES256_GCM,data:RIestx4igw==,iv:Y8m8siUkik4D0GiFD8UD+DCCCLjoEaqIb1SIOiWxQDE=,tag:QMcf7cgzH39vdIbUWbYD1w==,type:str]
    psqpass: ENC[AES256_GCM,data:5ENJ4fMpHQ==,iv:GR3BY4QSPe8gNYfTj3gVIILBSf7g2KyW0nr5bzHN1Ts=,tag:2g9Pp/AYcWcwJ8Uu+cYaMw==,type:str]
  docker:
    name: docker-secret   
###############################################################
# Balanceador de carga
Load:
  name: app-hpa
  spec:
    maxrep: 5 # Numero maximo de replicas
    minrep: 2 # Numero minimo de replicas
  resource:
    avrcpu: 20 # Modificar el porcentaje de utilizacion de CPU
###############################################################
# Ingress
Ingress:
  name: web-igrss
  host: 192-168-49-2.nip.io # Se usa la IP de minikube tunel



    